{% extends "base.html" %}
{% block content %}
    <div class="noise-overlay"></div>
    <div class="container mx-auto px-4 py-8 max-w-7xl relative z-10">
        <div class="flex justify-between items-center mb-16 space-x-4">
            <div>
                <h1 class="text-5xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-green-400 via-blue-500 to-purple-500">
                    Bibliothèque des Mémoires
                </h1>
                <p class="text-lg text-gray-400 max-w-xl">
                    Une archive numérique innovative qui transcende les frontières de la connaissance académique.
                </p>
            </div>

            <button 
                @click="toggleDarkMode()"
                class="relative group p-2 rounded-full bg-gray-800 hover:bg-gray-700 focus:outline-none"
            >
                <svg 
                    x-show="darkMode" 
                    class="w-6 h-6 text-yellow-400 transform transition-transform group-hover:rotate-12" 
                    fill="currentColor" 
                    viewBox="0 0 20 20"
                >
                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0  ```html
100 2h1z" clip-rule="evenodd" />
                </svg>
                <svg 
                    x-show="!darkMode" 
                    class="w-6 h-6 text-gray-400 transform transition-transform group-hover:rotate-12" 
                    fill="currentColor" 
                    viewBox="0 0 20 20"
                >
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
                </svg>
            </button>
        </div>

        <!-- Formulaire de Recherche -->
<form method="get" class="mb-8 search-container rounded-2xl p-6 bg-gray-900">
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-[1fr_200px_200px]">
        <!-- Champ de recherche -->
        <div class="relative">
            <input 
                type="text" 
                name="q" 
                placeholder="Rechercher un mémoire..." 
                value="{{ request.GET.q }}" 
                class="w-full px-4 py-3 rounded-lg border border-gray-700 bg-gray-800 text-gray-300 focus:ring-2 focus:ring-green-400"
            >
            <svg class="absolute right-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
        </div>

        <!-- Sélecteur de domaine -->
        <select 
            name="domaine" 
            class="px-4 py-3 rounded-lg border border-gray-700 bg-gray-800 text-gray-300 focus:ring-2 focus:ring-green-400"
        >
            <option value="">Tous les domaines</option>
            {% for domaine in domaines %}
                <option value="{{ domaine }}" {% if request.GET.domaine == domaine %}selected{% endif %}>
                    {{ domaine }}
                </option>
            {% endfor %}
        </select>

        <!-- Sélecteur d'année -->
        <select 
            name="annee" 
            class="px-4 py-3 rounded-lg border border-gray-700 bg-gray-800 text-gray-300 focus:ring-2 focus:ring-green-400"
        >
            <option value="">Toutes les années</option>
            {% for annee in annees %}
                <option value="{{ annee }}" {% if request.GET.annee == annee|stringformat:"s" %}selected{% endif %}>
                    {{ annee }}
                </option>
            {% endfor %}
        </select>
    </div>

    <!-- Bouton de soumission -->
    <div class="mt-4 text-center">
        <button 
            type="submit" 
            class="px-10 py-3 rounded-lg text-white font-medium bg-green-500 hover:bg-green-600 transition duration-200"
        >
            Rechercher
        </button>
    </div>
</form>


        <!-- Liste des Mémoires -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-10">
            {% for memoire in memoires %}
            <div class="card rounded-2xl shadow-2xl transform transition-all duration-300">
                {% if memoire.images %}
                <div class="relative h-64 overflow-hidden rounded-t-2xl">
                    <img 
                        src="{{ memoire.images.url }}" 
                        alt="{{ memoire.titre }}" 
                        class="absolute inset-0 w-full h-full object-cover filter brightness-75 scale-100 hover:scale-110 transition-transform duration-300"
                    >
                </div>
                {% endif %}
                <div class="p-8">
                    <h2 class="text-2xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500">
                        {{ memoire.titre }}
                    </h2>
                    <div class="space-y-3 mb-6">
                        <p class="flex items-center text-gray-400">
                            <svg class="w-6 h-6 mr-3 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m- ```html
2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m3 4v-4m0 4h2a2 2 0 002-2v-4a2 2 0 00-2-2h-2v6z" />
                            </svg>
                            <span>{{ memoire.domaine }}</span>
                        </p>
                        <p class="flex items-center text-gray-400">
                            <svg class="w-6 h-6 mr-3 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                            {{ memoire.auteur.prenom }} {{ memoire.auteur.nom }}
                        </p>
                        <p class="flex items-center text-gray-400">
                            <span>{{ memoire.annee }}</span>
                        </p>
                    </div>
                    <p class="text-gray-300 mb-6 line-clamp-3">
                        {{ memoire.description|truncatechars:150 }}
                    </p>
                    <div class="flex justify-between items-center">
                        <a 
                            href="#" 
                            class="px-6 py-3 rounded-xl bg-gradient-to-r from-green-400 to-blue-500 text-white hover:opacity-90 transition-all"
                        >
                            Voir les détails
                        </a>
                        <div class="flex items-center space-x-3">
                            <button class="text-gray-400 hover:text-white transition-colors">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                                </svg>
                            </button>
                            <button class="text-gray-400 hover:text-white transition-colors">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Pagination -->
        {% if is_paginated %}
        <div class="mt-16 flex justify-center space-x-4">
            {% if page_obj.has_previous %}
            <a 
                href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.domaine %}&domaine={{ request.GET.domaine }}{% endif %}{% if request.GET.annee %}&annee={{ request.GET.annee }}{% endif %}" 
                class="px-6 py-3 rounded-xl bg-gray-800 hover:bg-gray-700 transition-colors"
            >
                Précédent
            </a>
            {% endif %}

            {% for num in page_obj.paginator.page_range %}
 {% if page_obj.number == num %}
                <span class="px-6 py-3 rounded-xl bg-gradient-to-r from-green-400 to-blue-500 text-white">
                    {{ num }}
                </span>
                {% else %}
                <a 
                    href="?page={{ num }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.domaine %}&domaine={{ request.GET.domaine }}{% endif %}{% if request.GET.annee %}&annee={{ request.GET.annee }}{% endif %}" 
                    class="px-6 py-3 rounded-xl bg-gray-800 hover:bg-gray-700 transition-colors"
                >
                    {{ num }}
                </a>
                {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
            <a 
                href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.domaine %}&domaine={{ request.GET.domaine }}{% endif %}{% if request.GET.annee %}&annee={{ request.GET.annee }}{% endif %}" 
                class="px-6 py-3 rounded-xl bg-gray-800 hover:bg-gray-700 transition-colors"
            >
                Suivant
            </a>
            {% endif %}
        </div>
        {% endif %}
    </div>
    {% endblock content %}